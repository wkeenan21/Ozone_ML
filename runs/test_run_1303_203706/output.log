2024-03-13 20:37:06,648: Logging to C:\Users\wkeenan\OneDrive - DOI\Documents\GitHub\Ozone_ML\runs\test_run_1303_203706\output.log initialized.
2024-03-13 20:37:06,648: ### Folder structure created at C:\Users\wkeenan\OneDrive - DOI\Documents\GitHub\Ozone_ML\runs\test_run_1303_203706
2024-03-13 20:37:06,648: ### Run configurations for test_run
2024-03-13 20:37:06,648: experiment_name: test_run
2024-03-13 20:37:06,648: train_basin_file: C:\Users\wkeenan\OneDrive - DOI\Documents\GitHub\Ozone_ML\Year2\scripts_dir\neuralHydro\trainingSites.txt
2024-03-13 20:37:06,648: validation_basin_file: C:\Users\wkeenan\OneDrive - DOI\Documents\GitHub\Ozone_ML\Year2\scripts_dir\neuralHydro\trainingSites.txt
2024-03-13 20:37:06,648: test_basin_file: C:\Users\wkeenan\OneDrive - DOI\Documents\GitHub\Ozone_ML\Year2\scripts_dir\neuralHydro\trainingSites.txt
2024-03-13 20:37:06,650: train_start_date: 2021-05-04 00:00:00
2024-03-13 20:37:06,650: train_end_date: 2022-03-06 00:00:00
2024-03-13 20:37:06,650: validation_start_date: 2021-05-04 00:00:00
2024-03-13 20:37:06,650: validation_end_date: 2022-03-06 00:00:00
2024-03-13 20:37:06,650: test_start_date: 2022-03-07 00:00:00
2024-03-13 20:37:06,650: test_end_date: 2022-08-06 00:00:00
2024-03-13 20:37:06,650: device: cpu
2024-03-13 20:37:06,650: validate_every: 3
2024-03-13 20:37:06,650: validate_n_random_basins: 1
2024-03-13 20:37:06,650: metrics: ['NSE', 'RMSE', 'Pearson-r']
2024-03-13 20:37:06,650: model: cudalstm
2024-03-13 20:37:06,650: head: regression
2024-03-13 20:37:06,651: output_activation: linear
2024-03-13 20:37:06,651: hidden_size: 20
2024-03-13 20:37:06,651: initial_forget_bias: 3
2024-03-13 20:37:06,651: output_dropout: 0.4
2024-03-13 20:37:06,651: optimizer: Adam
2024-03-13 20:37:06,651: loss: MSE
2024-03-13 20:37:06,651: learning_rate: {0: 0.01, 30: 0.005, 40: 0.001}
2024-03-13 20:37:06,651: batch_size: 256
2024-03-13 20:37:06,651: epochs: 25
2024-03-13 20:37:06,651: clip_gradient_norm: 1
2024-03-13 20:37:06,651: use_frequencies: 1H
2024-03-13 20:37:06,651: predict_last_n: {'1H': 24}
2024-03-13 20:37:06,651: seq_length: {'1H': 24}
2024-03-13 20:37:06,651: num_workers: 8
2024-03-13 20:37:06,651: log_interval: 5
2024-03-13 20:37:06,651: log_tensorboard: True
2024-03-13 20:37:06,651: log_n_figures: 1
2024-03-13 20:37:06,651: save_weights_every: 1
2024-03-13 20:37:06,651: dataset: ozone_dataset
2024-03-13 20:37:06,651: data_dir: C:\Users\wkeenan\OneDrive - DOI\Documents\GitHub\Ozone_ML\Year2\Merged_Data\nh
2024-03-13 20:37:06,651: dynamic_inputs: ['u10', 'v10', 'r2', 'sp', 't2m', 'dswrf', 'MAXUVV', 'MAXDVV']
2024-03-13 20:37:06,651: target_variables: ['o3']
2024-03-13 20:37:06,651: clip_targets_to_zero: ['o3']
2024-03-13 20:37:06,651: number_of_basins: 11
2024-03-13 20:37:06,651: run_dir: C:\Users\wkeenan\OneDrive - DOI\Documents\GitHub\Ozone_ML\runs\test_run_1303_203706
2024-03-13 20:37:06,651: train_dir: C:\Users\wkeenan\OneDrive - DOI\Documents\GitHub\Ozone_ML\runs\test_run_1303_203706\train_data
2024-03-13 20:37:06,652: img_log_dir: C:\Users\wkeenan\OneDrive - DOI\Documents\GitHub\Ozone_ML\runs\test_run_1303_203706\img_log
2024-03-13 20:37:06,654: ### Device cpu will be used for training
2024-03-13 20:37:06,654: Loading basin data into xarray data set.
2024-03-13 20:37:07,111: Create lookup table and convert to pytorch tensor
2024-03-13 20:37:38,032: Epoch 1 average loss: avg_loss: 0.19647, avg_total_loss: 0.19647
2024-03-13 20:38:09,065: Epoch 2 average loss: avg_loss: 0.17045, avg_total_loss: 0.17045
2024-03-13 20:38:39,051: Epoch 3 average loss: avg_loss: 0.16555, avg_total_loss: 0.16555
2024-03-13 20:38:42,901: Epoch 3 average validation loss: 0.16096 -- Median validation metrics: avg_loss: 0.16096, NSE: 0.72022, RMSE: 0.00850, Pearson-r: 0.85251
2024-03-13 20:39:16,973: Epoch 4 average loss: avg_loss: 0.16248, avg_total_loss: 0.16248
2024-03-13 20:39:47,303: Epoch 5 average loss: avg_loss: 0.15974, avg_total_loss: 0.15974
2024-03-13 20:40:19,392: Epoch 6 average loss: avg_loss: 0.15811, avg_total_loss: 0.15811
2024-03-13 20:40:22,202: Epoch 6 average validation loss: 0.15307 -- Median validation metrics: avg_loss: 0.15307, NSE: 0.73278, RMSE: 0.00831, Pearson-r: 0.85929
2024-03-13 20:40:53,165: Epoch 7 average loss: avg_loss: 0.15641, avg_total_loss: 0.15641
2024-03-13 20:41:26,692: Epoch 8 average loss: avg_loss: 0.15514, avg_total_loss: 0.15514
2024-03-13 20:42:03,390: Epoch 9 average loss: avg_loss: 0.15422, avg_total_loss: 0.15422
2024-03-13 20:42:06,977: Epoch 9 average validation loss: 0.10691 -- Median validation metrics: avg_loss: 0.10691, NSE: 0.74892, RMSE: 0.00659, Pearson-r: 0.86608
2024-03-13 20:42:41,107: Epoch 10 average loss: avg_loss: 0.15364, avg_total_loss: 0.15364
2024-03-13 20:43:13,159: Epoch 11 average loss: avg_loss: 0.15282, avg_total_loss: 0.15282
2024-03-13 20:43:45,982: Epoch 12 average loss: avg_loss: 0.15191, avg_total_loss: 0.15191
2024-03-13 20:43:48,337: Epoch 12 average validation loss: 0.10353 -- Median validation metrics: avg_loss: 0.10353, NSE: 0.78318, RMSE: 0.00668, Pearson-r: 0.88884
2024-03-13 20:44:28,160: Epoch 13 average loss: avg_loss: 0.15142, avg_total_loss: 0.15142
2024-03-13 20:45:10,922: Epoch 14 average loss: avg_loss: 0.15086, avg_total_loss: 0.15086
2024-03-13 20:45:51,400: Epoch 15 average loss: avg_loss: 0.15042, avg_total_loss: 0.15042
2024-03-13 20:45:55,589: Epoch 15 average validation loss: 0.13589 -- Median validation metrics: avg_loss: 0.13589, NSE: 0.77247, RMSE: 0.00755, Pearson-r: 0.88594
2024-03-13 20:46:36,068: Epoch 16 average loss: avg_loss: 0.15011, avg_total_loss: 0.15011
2024-03-13 20:47:27,050: Epoch 17 average loss: avg_loss: 0.14923, avg_total_loss: 0.14923
2024-03-13 20:48:23,735: Epoch 18 average loss: avg_loss: 0.14911, avg_total_loss: 0.14911
2024-03-13 20:48:26,996: Epoch 18 average validation loss: 0.09457 -- Median validation metrics: avg_loss: 0.09457, NSE: 0.71779, RMSE: 0.00663, Pearson-r: 0.85788
2024-03-13 20:49:09,761: Epoch 19 average loss: avg_loss: 0.14862, avg_total_loss: 0.14862
2024-03-13 20:49:48,390: Epoch 20 average loss: avg_loss: 0.14880, avg_total_loss: 0.14880
2024-03-13 20:50:30,422: Epoch 21 average loss: avg_loss: 0.14780, avg_total_loss: 0.14780
2024-03-13 20:50:33,838: Epoch 21 average validation loss: 0.12989 -- Median validation metrics: avg_loss: 0.12989, NSE: 0.76514, RMSE: 0.00747, Pearson-r: 0.87587
2024-03-13 20:51:14,718: Epoch 22 average loss: avg_loss: 0.14801, avg_total_loss: 0.14801
2024-03-13 20:51:52,830: Epoch 23 average loss: avg_loss: 0.14778, avg_total_loss: 0.14778
2024-03-13 20:52:33,284: Epoch 24 average loss: avg_loss: 0.14741, avg_total_loss: 0.14741
2024-03-13 20:52:36,246: Epoch 24 average validation loss: 0.09894 -- Median validation metrics: avg_loss: 0.09894, NSE: 0.79816, RMSE: 0.00645, Pearson-r: 0.89371
2024-03-13 20:53:13,890: Epoch 25 average loss: avg_loss: 0.14715, avg_total_loss: 0.14715
2024-03-13 21:03:18,585: Using the model weights from C:\Users\wkeenan\OneDrive - DOI\Documents\GitHub\Ozone_ML\runs\test_run_1303_203706\model_epoch025.pt
2024-03-13 21:03:23,408: Stored metrics at C:\Users\wkeenan\OneDrive - DOI\Documents\GitHub\Ozone_ML\runs\test_run_1303_203706\test\model_epoch025\test_metrics.csv
2024-03-13 21:03:23,418: Stored results at C:\Users\wkeenan\OneDrive - DOI\Documents\GitHub\Ozone_ML\runs\test_run_1303_203706\test\model_epoch025\test_results.p
